<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>INSTITUTO - SWAD</title>
  <link rel="stylesheet" href="../bootstrap-5.3.3-dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="../css/cliente.css">

</head>

<body>
  <!-- Navbar superior -->
  <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #222;">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">INSTITUTO SWAB</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button"
              data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle me-2 fs-5"></i> Rector
            </a>
            <ul class="dropdown-menu dropdown-menu-end custom-dropdown" aria-labelledby="userDropdown">
              <li><a class="dropdown-item" href="#"><i class="bi bi-person-fill me-2"></i>Perfil</a></li>
              <li><a class="dropdown-item" href="#"><i class="bi bi-gear-fill me-2"></i>Configuración</a></li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li><a class="dropdown-item" href="#" onclick="logout()">Cerrar sesión</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>


  <!-- Sidebar estilo elegante con fondo animado -->
  <aside class="sidebar" id="sidebar" role="navigation" aria-label="Menú lateral">
    <video autoplay muted loop>
      <source src="../img/fondo_animado.mp4" type="video/mp4" />
      Tu navegador no soporta el video.
    </video>

    <ul>
      <li>
        <a href="#" onclick="mostrarContenido('inicio')">
          <i class="bi bi-house-door"></i><span>Inicio</span>
        </a>
      </li>
      <li>
        <a href="#" onclick="mostrarContenido('crear')">
          <i class="bi bi-person-plus"></i><span>Crear Docentes</span>
        </a>
      </li>
      <li>
        <a href="#" onclick="mostrarContenido('buscar')">
          <i class="bi bi-search"></i><span>Buscar Docentes</span>
        </a>
      </li>
      <li>
        <a href="#" onclick="mostrarContenido('listado')">
          <i class="bi bi-card-list"></i><span>Listado de Docentes</span>
        </a>
      </li>
    </ul>
  </aside>

  <!-- Botón para mostrar/ocultar sidebar -->
  <button class="toggle-btn" onclick="toggleSidebar()">☰</button>

  <!-- Contenido principal -->
  <div class="container mt-4" id="contenido-principal">
    <div id="contenido-inicio">
      <h2 class="mb-4">Panel Principal Instituto</h2>
      <div class="cards-grid">
        <!-- Tarjeta: Generar Diploma -->
        <div class="card text-center shadow-sm hover-card">
          <div class="card-body">
            <i class="bi bi-file-earmark-text icon-dashboard"></i>
            <h5 class="card-title mt-2">Generar Diploma</h5>
            <p class="card-text">Crea un nuevo diploma con los datos ingresados.</p>
            <a href="#" class="btn btn-outline-primary">Ir</a>
          </div>
        </div>
        <!-- Tarjeta: Guardar Datos -->
        <div class="card text-center shadow-sm hover-card">
          <div class="card-body">
            <i class="bi bi-save icon-dashboard"></i>
            <h5 class="card-title mt-2">Guardar Datos</h5>
            <p class="card-text">Almacena la información de manera segura.</p>
            <a href="#" class="btn btn-outline-success">Ir</a>
          </div>
        </div>
        <!-- Tarjeta: Imprimir Diploma -->
        <div class="card text-center shadow-sm hover-card">
          <div class="card-body">
            <i class="bi bi-printer icon-dashboard"></i>
            <h5 class="card-title mt-2">Imprimir Diploma</h5>
            <p class="card-text">Imprime el diploma generado.</p>
            <a href="#" class="btn btn-outline-warning">Ir</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="contenido-crear" style="display:none;">
    <div id="contenido-crear" style="display:none;" class="d-flex justify-content-center align-items-center py-4">
      <section id="crearDocente" class="seccion" style="width: 100%; max-width: 800px;">
        <!-- contenido del formulario -->
        <h2>Crear Nuevo Docente</h2>
        <form id="clienteForm" action="../backend/profesores.php" method="POST">
          <div class="row g-3">


            <!-- Información del Docente -->
            <div class="col-md-6">
              <input type="text" id="nombre_docente" name="docente_name" class="form-control"
                placeholder="Nombre del docente" required>
              <div class="error" id="error_nombre_rector"></div>
            </div>
            <div class="col-md-6">
              <input type="text" id="apellidos" name="rector_surname" class="form-control"
                placeholder="Apellidos del docente" required>
              <div class="error" id="error_apellidos"></div>
            </div>
            <div class="col-md-6">
              <select id="tipo_documento" name="document_type" class="form-select" required>
                <option value="" selected disabled>Tipo de Documento del Docente</option>
                <option value="1">Cédula de Ciudadania</option>
                <option value="2">Tarjeta de Identidad</option>
                <option value="3">Cédula de Extranjería</option>
                <option value="4">Pasaporte</option>
                <option value="5">Documento nacional de identificacion</option>
                <option value="6">Permiso especial de permanencia</option>
                <option value="7">Registro civil de nacimiento</option>
                <option value="8">Licencia de conduccion</option>
                <option value="9">Numero de identificacion tributaria</option>
                <option value="10">Otro</option>
              </select>
              <div class="error" id="error_tipo_documento"></div>
            </div>
            <div class="col-md-6">
              <input type="text" id="doc_docente" name="document_number" class="form-control"
                placeholder="Número de Documento del docente" required maxlength="30">
              <div class="error" id="error_doc_docente"></div>
            </div>

            <!-- Datos de Docente -->
            <div class="col-md-6">
              <input type="text" id="docente" name="username" class="form-control" placeholder="Nombre del docente"
                required maxlength="50">
              <div class="error" id="error_docente"></div>
            </div>
            <div class="col-md-6">
              <input type="password" id="contrasena" name="password" class="form-control" placeholder="Contraseña"
                required>
              <div class="error" id="error_contrasena"></div>
            </div>

            <!-- Firma del Docente con Canvas -->
            <div class="col-md-12">
              <label for="firmaCanvas" class="form-label">Firma del Docente (dibuje aquí) </label>
              <div class="error" id="error_firma_docente"> </div>
              <canvas id="firmaCanvas" width="400" height="150" style="border:1px solid #ccc; display: block;"></canvas>
              <div class="mt-2">
                <button type="button" class="btn btn-secondary btn-sm" onclick="borrarFirma()">Borrar Firma</button>
              </div>
              <!-- Campo oculto para guardar la firma en base64 -->
              <input type="hidden" id="firmaBase64" name="firmaBase64" required>

            </div>
          </div>

          <button type="submit" class="btn btn-primary mt-3" id="btnEnviar">Crear Docente</button>
          <p id="clienteMsg" class="mt-2"></p>
        </form>
      </section>
    </div>
  </div>

  <!-- Aquí puedes agregar tu formulario de creación -->
  <div id="contenido-buscar" style="display:none;">
    <div class="contenedor-buscar">
      <h2>Buscar Profesores</h2>
      <form id="form-buscar-profesor">
        <label for="busqueda">Buscar:</label>
        <input type="text" id="busqueda" name="busqueda" placeholder="ID, nombres o número de documento">
        <button type="submit">Buscar</button>
      </form>

      <div id="resultados">
        <!-- Aquí se mostrarán los resultados -->
      </div>
    </div>
  </div>


  <div id="contenido-listado" style="display:none;">
    <div class="container mt-5 py-4">
      <h2 class="mb-4">Listado de Profesores</h2>

      <!-- Sección: Listado de Profesores -->
      <div class="table-responsive">
        <table class="table table-striped" id="profesorTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombres</th>
              <th>Apellidos</th>
              <th>Documento</th>
              <th>Fecha Nac.</th>
              <th>Correo</th>
              <th>Usuario</th>
              <th>Empresa</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <!-- Se llenará dinámicamente -->
          </tbody>
        </table>
      </div>
    </div>
  </div>



  <!-- Bootstrap JS Bundle -->
  <script src="../bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
  <!-- Scripts propios -->
  <script src="../js/cliente.js"></script>
  <!--script src="../js/auth.js"></script-->


  <script>
    document.getElementById('form-buscar-profesor').addEventListener('submit', function (e) {
      e.preventDefault();

      const busqueda = document.getElementById('busqueda').value;

      fetch(`../backend/buscar_profesor.php?busqueda=${busqueda}`)
        .then(response => response.json())
        .then(data => {
          const resultadosDiv = document.getElementById('resultados');
          resultadosDiv.innerHTML = '';

          if (data.length > 0) {
            const table = document.createElement('table');
            table.classList.add('table', 'table-striped');

            table.innerHTML = `
            <thead>
              <tr>
                <th>ID</th>
                <th>Nombres</th>
                <th>Apellidos</th>
                <th>Tipo Documento</th>
                <th>Número Documento</th>
                <th>Correo</th>
                <th>Teléfono</th>
                <th>Usuario</th>
                <th>Fecha Registro</th>
              </tr>
            </thead>
            <tbody>
              ${data.map(profesor => `
                <tr>
                  <td>${profesor.id_docente}</td>
                  <td>${profesor.nombres}</td>
                  <td>${profesor.apellidos}</td>
                  <td>${profesor.id_tipodoc}</td>
                  <td>${profesor.num_documento}</td>
                  <td>${profesor.correo}</td>
                  <td>${profesor.telefono}</td>
                  <td>${profesor.usuario}</td>
                  <td>${profesor.fecha_registro}</td>
                </tr>
              `).join('')}
            </tbody>
          `;

            resultadosDiv.appendChild(table);
          } else {
            resultadosDiv.innerHTML = '<p>No se encontraron resultados.</p>';
          }
        })
        .catch(error => console.error('Error:', error));
    });
  </script>

  <script>
    function toggleSidebar() {
      const sidebar = document.querySelector('.sidebar');
      const content = document.querySelector('.content');
      const toggleBtn = document.querySelector('.toggle-btn');

      sidebar.classList.toggle('collapsed');

      if (sidebar.classList.contains('collapsed')) {
        content.style.marginLeft = '70px';
        toggleBtn.style.left = '80px';
      } else {
        content.style.marginLeft = '250px';
        toggleBtn.style.left = '260px';
      }
    }
  </script>


  <script>
    function logout() {
      // Elimina los datos de sesión o autenticación del almacenamiento local
      localStorage.removeItem("rol"); // u otros datos como 'token', 'usuario', etc.

      // Redirige al usuario a la página de inicio de sesión
      window.location.href = "../html/index.html"; // Ajusta la ruta según tu estructura
    }
  </script>

</body>

</html>